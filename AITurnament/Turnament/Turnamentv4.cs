// clean up and make it faster and prepare for v5